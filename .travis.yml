dist: xenial
language: minimal

git:
  quiet: true
  submodules: false

branches:
  only:
  - master
  - deploy

env:
# Carefull, also set it in the deploy section!
- NOTES_FILE=notes

services:
- docker

script:
- docker run --rm -v $(pwd):/notes blang/latex /bin/bash -c "cd /notes; ./build.sh $NOTES_FILE"
- "./test.sh $NOTES_FILE"

deploy:
  provider: releases
  api_key:
    secure: EtotMhwR9fpNuk8kuST+ESWwgknjnf8h9yZW4WeKfcqJdlMcYk5F9OtgEbIuorU3wIe1yMXt+EfMBF/RyZFJUF8Ul3rdE086mLvwfqloFSiCe2pnezTtY/rAoe/biH/J/9XCOYXTGcxiKJGhRr13LQcCPY+LR5WvbGzwQ6gUNaTzXg5KopDxMGUPf/ilwS/Hz8PPRusuUOJ2K5upRtkwmlXqqj1l+xRYvAtiPB7p2b2GxPbjrgJN1YXQY6BY4CKwZNFuzemVG7BL7576/3K9ZtzkxVzm1l14tCyQOdo75PASS6VpiyvskZRTEO1Z1LqF+aCtjg6TQqbP1LUE+nI+Na6e6PybSp28e5WJyrOH/GTnWetxYdSSEPxDZwsMXRHvMonPuaInr1bUJ9ipOLJ1YzqXWd/PH82KreVom1vbf4D4xwSKB3J1V11CqqArwCeKlFUAsUsZ+3yyobQZVuKayzh23JRP4UyNpRPh3Y/UxUOvyBPzMNlENYvy0p5qcQkrfIiQbf6r57OomHLNHj5NirBy9eKWPRgbHSodmVkfPOMi2VHDxVWifrXwB1lmOPnf9M5jIzLlp5jGDSB/D4xX+5I2Y9HWt1vDKc8N5D1IllhUqgihqiGQ+I17r1jEHwhHIRhaOvINQdHaZPwHhcsXwAhmPNN/VJfhE6erHK+eSOU=
  file: notes.pdf
  skip_cleanup: true
  on:
    repo: icl-notes/m3p19
